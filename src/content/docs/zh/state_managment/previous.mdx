---
title: usePrevious Hook
description: 一个自定义的 React Hook，用于在函数组件中跟踪变量的上一个值。
---

import UsePrevious from "@hook/previous/demo";

## 介绍

`usePrevious` Hook 是一个自定义的 React Hook，用于在函数组件中跟踪变量的上一个值。当您需要将当前值与之前的值进行比较，例如基于变化触发操作或渲染时，这个 Hook 尤其有用。

## 演示

<UsePrevious client:visible />

### 参数

| 名称    | 类型 | 描述                         |
| ------- | ---- | ---------------------------- |
| `value` | any  | 要跟踪并返回上一个值的变量。 |

### 返回值

| 名称            | 类型 | 描述                        |
| --------------- | ---- | --------------------------- |
| `previousValue` | any  | 提供的 `value` 的上一个值。 |

### 使用方法

1. 在组件中导入 `usePrevious` Hook：

```jsx
import { usePrevious } from "@cannonui/reacthooks";
```

2. 在组件中初始化 Hook：

```jsx
import { usePrevious } from "@cannonui/reacthooks";
import { useState } from "react";
const TestUsePrevious = () => {
  const [value, setValue] = useState < number > 0;
  const previous = usePrevious(value);

  const handleUpdate = () => {
    setValue((value) => value + 1);
  };

  return (
    <>
      <div>previous value: {previous}</div>
      <div>current value: {value}</div>
      <button onClick={handleUpdate}>Update</button>
    </>
  );
};

export default TestUsePrevious;
```

### 工作原理

`usePrevious` Hook 使用了 React 中的 `useRef` 和 `useEffect` Hook。它使用 `useRef` 在一个 `ref` 中存储 `value` 属性的上一个值。当 `value` 属性发生变化时，`useEffect` Hook 会更新 `ref.current` 为新的值，从而有效地跟踪了上一个值。

### 示例

在上面的示例中，我们创建了一个简单的组件 `TestUsePrevious`，它使用 `usePrevious` Hook 来跟踪和显示上一个值和当前值。每当点击 "更新" 按钮时，组件会增加 `value` 状态，而 `usePrevious` Hook 则返回并显示上一个值。

这个自定义 Hook 在需要基于值的变化执行操作或显示值的历史记录时非常有用。

---
